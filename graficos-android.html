
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="unity.html">
      
      
        <link rel="next" href="graficos-ios.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.1">
    
    
      
        <title>Gráficos de alto rendimiento en Android - Gráficos y Multimedia</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.402914a4.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="Indigo" data-md-color-accent="Indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#graficos-de-alto-rendimiento-en-android" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Gráficos y Multimedia" class="md-header__button md-logo" aria-label="Gráficos y Multimedia" data-md-component="logo">
      
  <img src="imagenes/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Gráficos y Multimedia
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Gráficos de alto rendimiento en Android
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Gráficos y Multimedia" class="md-nav__button md-logo" aria-label="Gráficos y Multimedia" data-md-component="logo">
      
  <img src="imagenes/logo.png" alt="logo">

    </a>
    Gráficos y Multimedia
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Introducción
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="formatos.html" class="md-nav__link">
        Formatos de audio y vídeo
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="streaming.html" class="md-nav__link">
        Difusión de medios
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="unity.html" class="md-nav__link">
        El motor Unity
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Gráficos de alto rendimiento en Android
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="graficos-android.html" class="md-nav__link md-nav__link--active">
        Gráficos de alto rendimiento en Android
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#surface-view" class="md-nav__link">
    Surface View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios" class="md-nav__link">
    Ejercicios
  </a>
  
    <nav class="md-nav" aria-label="Ejercicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graficos-3d" class="md-nav__link">
    Gráficos 3D
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="graficos-ios.html" class="md-nav__link">
        Gráficos en iOS
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="reproduccion-ios.html" class="md-nav__link">
        Reproducción de medios en iOS
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="captura-ios.html" class="md-nav__link">
        Captura y procesamiento de medios en iOS
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="procesamiento-de-imagen-en-ios-opencv.html" class="md-nav__link">
        Procesamiento de imágenes en iOS - OpenCV
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="reproduccion-android.html" class="md-nav__link">
        Reproducción de medios en Android
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="captura-android.html" class="md-nav__link">
        Captura de medios en Android
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="procesamiento-android.html" class="md-nav__link">
        Emisión de medios
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="mirroring.html" class="md-nav__link">
        Reproducción en dispositivos externos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="adobe-air.html" class="md-nav__link">
        Aplicaciones Adobe Air
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="habla-android.html" class="md-nav__link">
        Síntesis y reconocimiento del habla
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#surface-view" class="md-nav__link">
    Surface View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios" class="md-nav__link">
    Ejercicios
  </a>
  
    <nav class="md-nav" aria-label="Ejercicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graficos-3d" class="md-nav__link">
    Gráficos 3D
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="graficos-de-alto-rendimiento-en-android">Gráficos de alto rendimiento en Android<a class="headerlink" href="#graficos-de-alto-rendimiento-en-android" title="Permanent link">&para;</a></h1>
<p>El principal objetivo de la sesión consiste en hacer una introducción a los componentes de la interfaz de Android que nos darán soporte para poder reproducir gráficos de alto rendimiento (vídeo o gráficos 3D).</p>
<h2 id="surface-view"><em>Surface View</em><a class="headerlink" href="#surface-view" title="Permanent link">&para;</a></h2>
<p>Para mostrar gráficos propios podríamos usar un componente que herede de <code>View</code>. Estos componentes funcionan bien si no necesitamos realizar repintados continuos o mostrar gráficos 3D.</p>
<p>Sin embargo, en el caso de tener una aplicación con una gran carga gráfica, como puede ser un videojuego, un reproductor de vídeo, o una aplicación que muestre gráficos 3D, en lugar de <code>View</code> deberemos utilizar <code>SurfaceView</code>. Esta última clase nos proporciona una superficie en la que podemos dibujar desde un hilo en segundo plano, lo cual libera al hilo principal de la aplicación de la carga gráfica.</p>
<p>Vamos a ver en primer lugar cómo crear subclases de <code>SurfaceView</code>, y las diferencias existentes con <code>View</code>.</p>
<p>Para crear una vista con <code>SurfaceView</code> tendremos que
crear una nueva subclase de dicha clase (en lugar de <code>View</code>). Pero en este caso no bastará con definir el método <code>onDraw</code>, ahora deberemos crearnos un hilo independiente y proporcionarle la superficie en la que dibujar (<code>SurfaceHolder</code>). Además, en nuestra subclase de <code>SurfaceView</code> también implementaremos la interfaz <code>SurfaceHolder.Callback</code> que nos permitirá estar al tanto de cuando la superficie se crea, cambia, o se destruye.</p>
<p>Cuando la superficie sea creada pondremos en marcha nuestro hilo de dibujado, y lo pararemos cuando la superficie sea destruida. A continuación mostramos un ejemplo de dicha clase:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">VistaSurface</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">SurfaceView</span>
<span class="w">              </span><span class="kd">implements</span><span class="w"> </span><span class="n">SurfaceHolder</span><span class="p">.</span><span class="na">Callback</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">HiloDibujo</span><span class="w"> </span><span class="n">hilo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">VistaSurface</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

<span class="w">        </span><span class="n">SurfaceHolder</span><span class="w"> </span><span class="n">holder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">getHolder</span><span class="p">();</span>
<span class="w">        </span><span class="n">holder</span><span class="p">.</span><span class="na">addCallback</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">surfaceChanged</span><span class="p">(</span><span class="n">SurfaceHolder</span><span class="w"> </span><span class="n">holder</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">format</span><span class="p">,</span>
<span class="w">                                 </span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// La superficie ha cambiado (formato o dimensiones)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">surfaceCreated</span><span class="p">(</span><span class="n">SurfaceHolder</span><span class="w"> </span><span class="n">holder</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">hilo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HiloDibujo</span><span class="p">(</span><span class="n">holder</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">hilo</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">surfaceDestroyed</span><span class="p">(</span><span class="n">SurfaceHolder</span><span class="w"> </span><span class="n">holder</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">hilo</span><span class="p">.</span><span class="na">detener</span><span class="p">();</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">hilo</span><span class="p">.</span><span class="na">join</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Como vemos, la clase <code>SurfaceView</code> simplemente se
encarga de obtener la superficie y poner en marcha o parar el hilo de dibujado. En este caso la acción estará realmente en el hilo, que es donde especificaremos la forma en la que se debe dibujar
el componente. Vamos a ver a continuación cómo podríamos implementar dicho hilo:</p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span> <span class="nc">HiloDibujo</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">SurfaceHolder</span><span class="w"> </span><span class="n">holder</span><span class="p">;</span>
<span class="w">    </span><span class="n">VistaSurface</span><span class="w"> </span><span class="n">vista</span><span class="p">;</span>
<span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">continuar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">HiloDibujo</span><span class="p">(</span><span class="n">SurfaceHolder</span><span class="w"> </span><span class="n">holder</span><span class="p">,</span><span class="w"> </span><span class="n">VistaSurface</span><span class="w"> </span><span class="n">vista</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">holder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">holder</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">vista</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vista</span><span class="p">;</span>
<span class="w">        </span><span class="n">continuar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">detener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">continuar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">continuar</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Canvas</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">holder</span><span class="p">.</span><span class="na">lockCanvas</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">                </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">holder</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// Dibujar aqui los graficos</span>
<span class="w">                    </span><span class="n">c</span><span class="p">.</span><span class="na">drawColor</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">BLUE</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">holder</span><span class="p">.</span><span class="na">unlockCanvasAndPost</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Podemos ver que en el bucle principal de nuestro hilo obtenermos el lienzo (<code>Canvas</code>) a partir de la superficie (<code>SurfaceHolder</code>) mediante el método <code>lockCanvas</code>. Esto deja el lienzo bloqueado para nuestro uso, por ese motivo es importante asegurarnos de que siempre se desbloquee. Para tal fin hemos puesto <code>unlockCanvasAndPost</code> dentro del bloque
<code>finally</code>. Además debemos siempre dibujar de forma sincronizada con el objeto <code>SurfaceHolder</code>, para así evitar problemas de concurrencia en el acceso a su lienzo.</p>
<p>Para aplicaciones como videojuegos 2D sencillos un código como el anterior puede ser suficiente (la clase <code>View</code> sería demasiado lenta para un videojuego). Sin embargo, lo realmente interesante es utilizar <code>SurfaceView</code> junto a OpenGL, para así poder mostrar gráficos 3D, o escalados, rotaciones y otras
transformaciones sobre superficies 2D de forma eficiente.</p>
<p>A continuación veremos un ejemplo de cómo utilizar OpenGL (concretamente OpenGL ES) vinculado a nuestra <code>SurfaceView</code>.</p>
<p>Realmente la implementación de nuestra clase que hereda de <code>SurfaceView</code> no cambiará, simplemente modificaremos nuestro hilo, que es quien realmente realiza el dibujado. Toda la inicialización de OpenGL deberá realizarse dentro de nuestro hilo (en el método <code>run</code>), ya que sólo se puede acceder a las operaciones
de dicha librería desde el mismo hilo en el que se inicializó. En caso de que intentásemos acceder desde otro hilo obtendríamos un error indicando que no existe ningún contexto activo de OpenGL.</p>
<p>En este caso nuestro hilo podría contener el siguiente código:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">initEGL</span><span class="p">();</span>
<span class="w">    </span><span class="n">initGL</span><span class="p">();</span>

<span class="w">    </span><span class="n">Triangulo3D</span><span class="w"> </span><span class="n">triangulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Triangulo3D</span><span class="p">();</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">angulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>

<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">continuar</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glClear</span><span class="p">(</span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_COLOR_BUFFER_BIT</span><span class="w"> </span><span class="o">|</span>
<span class="w">                   </span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_DEPTH_BUFFER_BIT</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Dibujar gráficos aquí</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glMatrixMode</span><span class="p">(</span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_MODELVIEW</span><span class="p">);</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glLoadIdentity</span><span class="p">();</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glTranslatef</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">5.0f</span><span class="p">);</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glRotatef</span><span class="p">(</span><span class="n">angulo</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glEnableClientState</span><span class="p">(</span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_VERTEX_ARRAY</span><span class="p">);</span>
<span class="w">        </span><span class="n">triangulo</span><span class="p">.</span><span class="na">dibujar</span><span class="p">(</span><span class="n">gl</span><span class="p">);</span>

<span class="w">        </span><span class="n">egl</span><span class="p">.</span><span class="na">eglSwapBuffers</span><span class="p">(</span><span class="n">display</span><span class="p">,</span><span class="w"> </span><span class="n">surface</span><span class="p">);</span>
<span class="w">        </span><span class="n">angulo</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>En primer lugar debemos inicializar la interfaz EGL, que hace de vínculo entre la plataforma nativa y la librería OpenGL:</p>
<div class="highlight"><pre><span></span><code><span class="n">EGL10</span><span class="w"> </span><span class="n">egl</span><span class="p">;</span>
<span class="n">GL10</span><span class="w"> </span><span class="n">gl</span><span class="p">;</span>
<span class="n">EGLDisplay</span><span class="w"> </span><span class="n">display</span><span class="p">;</span>
<span class="n">EGLSurface</span><span class="w"> </span><span class="n">surface</span><span class="p">;</span>
<span class="n">EGLContext</span><span class="w"> </span><span class="n">contexto</span><span class="p">;</span>
<span class="n">EGLConfig</span><span class="w"> </span><span class="n">config</span><span class="p">;</span>

<span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initEGL</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">egl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">EGL10</span><span class="p">)</span><span class="n">EGLContext</span><span class="p">.</span><span class="na">getEGL</span><span class="p">();</span>
<span class="w">    </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">egl</span><span class="p">.</span><span class="na">eglGetDisplay</span><span class="p">(</span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_DEFAULT_DISPLAY</span><span class="p">);</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="n">egl</span><span class="p">.</span><span class="na">eglInitialize</span><span class="p">(</span><span class="n">display</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">);</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="n">atributos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="o">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_RED_SIZE</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">        </span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_GREEN_SIZE</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">        </span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_BLUE_SIZE</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">        </span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_DEPTH_SIZE</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">        </span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_NONE</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">EGLConfig</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="n">configs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">EGLConfig</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="n">numConfigs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="n">egl</span><span class="p">.</span><span class="na">eglChooseConfig</span><span class="p">(</span><span class="n">display</span><span class="p">,</span><span class="w"> </span><span class="n">atributos</span><span class="p">,</span><span class="w"> </span><span class="n">configs</span><span class="p">,</span>
<span class="w">                        </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numConfigs</span><span class="p">);</span>

<span class="w">    </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">configs</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="n">surface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">egl</span><span class="p">.</span><span class="na">eglCreateWindowSurface</span><span class="p">(</span><span class="n">display</span><span class="p">,</span>
<span class="w">                        </span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">holder</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<span class="w">    </span><span class="n">contexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">egl</span><span class="p">.</span><span class="na">eglCreateContext</span><span class="p">(</span><span class="n">display</span><span class="p">,</span><span class="w"> </span><span class="n">config</span><span class="p">,</span>
<span class="w">                        </span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_NO_CONTEXT</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<span class="w">    </span><span class="n">egl</span><span class="p">.</span><span class="na">eglMakeCurrent</span><span class="p">(</span><span class="n">display</span><span class="p">,</span><span class="w"> </span><span class="n">surface</span><span class="p">,</span><span class="w"> </span><span class="n">surface</span><span class="p">,</span><span class="w"> </span><span class="n">contexto</span><span class="p">);</span>

<span class="w">    </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">GL10</span><span class="p">)</span><span class="n">contexto</span><span class="p">.</span><span class="na">getGL</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>A continuación debemos proceder a la inicialización de la interfaz de la librería OpenGL:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initGL</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vista</span><span class="p">.</span><span class="na">getWidth</span><span class="p">();</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vista</span><span class="p">.</span><span class="na">getHeight</span><span class="p">();</span>
<span class="w">    </span><span class="n">gl</span><span class="p">.</span><span class="na">glViewport</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">);</span>
<span class="w">    </span><span class="n">gl</span><span class="p">.</span><span class="na">glMatrixMode</span><span class="p">(</span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_PROJECTION</span><span class="p">);</span>
<span class="w">    </span><span class="n">gl</span><span class="p">.</span><span class="na">glLoadIdentity</span><span class="p">();</span>

<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">aspecto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">width</span><span class="o">/</span><span class="n">height</span><span class="p">;</span>
<span class="w">    </span><span class="n">GLU</span><span class="p">.</span><span class="na">gluPerspective</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="mf">45.0f</span><span class="p">,</span><span class="w"> </span><span class="n">aspecto</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">30.0f</span><span class="p">);</span>
<span class="w">    </span><span class="n">gl</span><span class="p">.</span><span class="na">glClearColor</span><span class="p">(</span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Una vez hecho esto, ya sólo nos queda ver cómo dibujar una malla 3D. Vamos a ver como ejemplo el dibujo de un triángulo:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Triangulo3D</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">FloatBuffer</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span>

<span class="w">    </span><span class="kt">float</span><span class="o">[]</span><span class="w"> </span><span class="n">vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">-</span><span class="mf">1f</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1f</span><span class="p">,</span><span class="w"> </span><span class="mf">0f</span><span class="p">,</span>
<span class="w">        </span><span class="mf">1f</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1f</span><span class="p">,</span><span class="w"> </span><span class="mf">0f</span><span class="p">,</span>
<span class="w">        </span><span class="mf">0f</span><span class="p">,</span><span class="w"> </span><span class="mf">1f</span><span class="p">,</span><span class="w"> </span><span class="mf">0f</span><span class="w"> </span><span class="p">};</span>


<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Triangulo3D</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ByteBuffer</span><span class="w"> </span><span class="n">bufferTemporal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ByteBuffer</span>
<span class="w">                   </span><span class="p">.</span><span class="na">allocateDirect</span><span class="p">(</span><span class="n">vertices</span><span class="p">.</span><span class="na">length</span><span class="o">*</span><span class="mi">4</span><span class="p">);</span>
<span class="w">        </span><span class="n">bufferTemporal</span><span class="p">.</span><span class="na">order</span><span class="p">(</span><span class="n">ByteOrder</span><span class="p">.</span><span class="na">nativeOrder</span><span class="p">());</span>
<span class="w">        </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bufferTemporal</span><span class="p">.</span><span class="na">asFloatBuffer</span><span class="p">();</span>
<span class="w">        </span><span class="n">buffer</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">vertices</span><span class="p">);</span>
<span class="w">        </span><span class="n">buffer</span><span class="p">.</span><span class="na">position</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">dibujar</span><span class="p">(</span><span class="n">GL10</span><span class="w"> </span><span class="n">gl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glVertexPointer</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_FLOAT</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">);</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glDrawArrays</span><span class="p">(</span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_TRIANGLES</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Para finalizar, es importante que cuando la superficie se destruya se haga una limpieza de los recursos utilizados por OpenGL:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">cleanupGL</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">egl</span><span class="p">.</span><span class="na">eglMakeCurrent</span><span class="p">(</span><span class="n">display</span><span class="p">,</span><span class="w"> </span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_NO_SURFACE</span><span class="p">,</span>
<span class="w">            </span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_NO_SURFACE</span><span class="p">,</span><span class="w"> </span><span class="n">EGL10</span><span class="p">.</span><span class="na">EGL_NO_CONTEXT</span><span class="p">);</span>
<span class="w">    </span><span class="n">egl</span><span class="p">.</span><span class="na">eglDestroySurface</span><span class="p">(</span><span class="n">display</span><span class="p">,</span><span class="w"> </span><span class="n">surface</span><span class="p">);</span>
<span class="w">    </span><span class="n">egl</span><span class="p">.</span><span class="na">eglDestroyContext</span><span class="p">(</span><span class="n">display</span><span class="p">,</span><span class="w"> </span><span class="n">contexto</span><span class="p">);</span>
<span class="w">    </span><span class="n">egl</span><span class="p">.</span><span class="na">eglTerminate</span><span class="p">(</span><span class="n">display</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Podemos llamar a este método cuando el hilo se detenga (debemos asegurarnos que se haya detenido llamando a <code>join</code> previamente).</p>
<p>A partir de Android 1.5 se incluye la clase
<code>GLSurfaceView</code>, que ya incluye la inicialización
del contexto GL y nos evita tener que hacer esto manualmente. Esto simplificará bastante el uso de la librería. Vamos a ver a continuación un ejemplo de cómo trabajar con dicha clase.</p>
<p>En este caso ya no será necesario crear una subclase de  <code>GLSurfaceView</code>, ya que la inicialización y gestión del hilo de OpenGL siempre es igual. Lo único que nos interesará cambiar es lo que se muestra en la escena. Para ello deberemos crear una subclase de <code>GLSurfaceViewRenderer</code> que nos obliga a definir los siguientes métodos:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MiRenderer</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">GLSurfaceView</span><span class="p">.</span><span class="na">Renderer</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">Triangulo3D</span><span class="w"> </span><span class="n">triangulo</span><span class="p">;</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">angulo</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">MiRenderer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">triangulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Triangulo3D</span><span class="p">();</span>
<span class="w">        </span><span class="n">angulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onSurfaceCreated</span><span class="p">(</span><span class="n">GL10</span><span class="w"> </span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="n">EGLConfig</span><span class="w"> </span><span class="n">config</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onSurfaceChanged</span><span class="p">(</span><span class="n">GL10</span><span class="w"> </span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Al cambiar el tamaño cambia la proyección</span>
<span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">aspecto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">w</span><span class="o">/</span><span class="n">h</span><span class="p">;</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glViewport</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">);</span>

<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glMatrixMode</span><span class="p">(</span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_PROJECTION</span><span class="p">);</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glLoadIdentity</span><span class="p">();</span>
<span class="w">        </span><span class="n">GLU</span><span class="p">.</span><span class="na">gluPerspective</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="mf">45.0f</span><span class="p">,</span><span class="w"> </span><span class="n">aspecto</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">30.0f</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onDrawFrame</span><span class="p">(</span><span class="n">GL10</span><span class="w"> </span><span class="n">gl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glClearColor</span><span class="p">(</span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">);</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glClear</span><span class="p">(</span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_COLOR_BUFFER_BIT</span><span class="w"> </span><span class="o">|</span>
<span class="w">                   </span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_DEPTH_BUFFER_BIT</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Dibujar gráficos aquí</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glMatrixMode</span><span class="p">(</span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_MODELVIEW</span><span class="p">);</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glLoadIdentity</span><span class="p">();</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glTranslatef</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">5.0f</span><span class="p">);</span>
<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glRotatef</span><span class="p">(</span><span class="n">angulo</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">        </span><span class="n">gl</span><span class="p">.</span><span class="na">glEnableClientState</span><span class="p">(</span><span class="n">GL10</span><span class="p">.</span><span class="na">GL_VERTEX_ARRAY</span><span class="p">);</span>
<span class="w">        </span><span class="n">triangulo</span><span class="p">.</span><span class="na">dibujar</span><span class="p">(</span><span class="n">gl</span><span class="p">);</span>

<span class="w">        </span><span class="n">angulo</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Podemos observar que será el método <code>onDrawFrame</code> en el que deberemos escribir el código para mostrar los gráficos. Con hacer esto será suficiente, y no tendremos que encargarnos de crear el hilo ni de inicializar ni destruir el contexto.</p>
<p>Para mostrar estos gráficos en la vista deberemos proporcionar nuestro <em>renderer</em> al objeto <code>GLSurfaceView</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">vista</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">GLSurfaceView</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">vista</span><span class="p">.</span><span class="na">setRenderer</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">MiRenderer</span><span class="p">());</span>
<span class="n">setContentView</span><span class="p">(</span><span class="n">vista</span><span class="p">);</span>
</code></pre></div>
<p>Por último, será importante transmitir los eventos <code>onPause</code> y <code>onResume</code> de nuestra actividad a la vista de OpenGL, para así liberar a la aplicación de la carga gráfica cuando permanezca en segundo plano. El código completo de la actividad quedaría como se
muestra a continuación:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MiActividad</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Activity</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">GLSurfaceView</span><span class="w"> </span><span class="n">vista</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span>
<span class="w">        </span><span class="n">vista</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">GLSurfaceView</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">vista</span><span class="p">.</span><span class="na">setRenderer</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">MiRenderer</span><span class="p">());</span>
<span class="w">        </span><span class="n">setContentView</span><span class="p">(</span><span class="n">vista</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onPause</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">super</span><span class="p">.</span><span class="na">onPause</span><span class="p">();</span>
<span class="w">        </span><span class="n">vista</span><span class="p">.</span><span class="na">onPause</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onResume</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">super</span><span class="p">.</span><span class="na">onResume</span><span class="p">();</span>
<span class="w">        </span><span class="n">vista</span><span class="p">.</span><span class="na">onResume</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="ejercicios">Ejercicios<a class="headerlink" href="#ejercicios" title="Permanent link">&para;</a></h2>
<p>Antes de empezar a crear los proyectos, debes descargarte las plantillas desde el repositorio <code>mastermoviles-multimedia-android</code> de <em>bitbucket</em>. En este repositorio se encuentran todas las plantillas que utilizaremos en los ejercicios Android de este módulo.</p>
<h3 id="graficos-3d">Gráficos 3D<a class="headerlink" href="#graficos-3d" title="Permanent link">&para;</a></h3>
<p>En las plantillas de la sesión tenemos una aplicación <code>Graficos</code> en la que podemos ver un ejemplo completo de cómo utilizar <code>SurfaceView</code> tanto para gráficos 2D con el <code>Canvas</code> como para gráficos 3D con OpenGL, y también de cómo utilizar <code>GLSurfaceView</code>.</p>
<ul>
<li>
<p>Si ejecutamos la aplicación veremos un triángulo rotando alrededor del eje Y. Observar el código fuente, y modificarlo para que el triángulo
rote alrededor del eje X, en lugar de Y.</p>
</li>
<li>
<p>También podemos ver que hemos creado, además de la clase <code>Triangulo3D</code>, la clase <code>Cubo3D</code>. Modificar el código para que en lugar de mostrar el triángulo se muestre el cubo.</p>
</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="assets/javascripts/bundle.b78d2936.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>